---
title: "Os 4 Tipos de filmes de Julia Roberts"
author: "Elton Dantas de Oliveira Mesquita"
output:
    html_document:
    df_print: paged
theme: sandstone
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
library(cluster)
library(plotly)
library(ggdendro)
library(broom)
library(ggbeeswarm)
library(rvest)
library(xml2)
library(factoextra)

source(here::here("code/lib.R"))
theme_set(theme_report())

knitr::opts_chunk$set(tidy = FALSE,
                      fig.width = 6,
                      fig.height = 5,
                      echo = TRUE)

paleta = c("#404E4D",
           "#92DCE5",
           "#938BA1",
           "#2D3142",
           "#F4743B")
```

```{r}
## ANTES DE USAR
# Para criar data/movies.csv
import_data("julia_roberts") # ou com o ator/atriz que você escolher
```


```{r read}
filmes = read_imported_data()
```

![](julia_roberts.jpg)


###Sobre a atriz

    Julia Fiona Roberts nunca sonhou que se tornaria a atriz mais popular dos Estados Unidos. Ainda criança, devido ao seu amor por animais, Julia queria ser veterinária, mas acabou estudando jornalismo. Quando seu irmão, Eric Roberts, atingiu certo sucesso em Hollywood, ela decidiu atuar. Sua primeira chance veio em 1988 quando ela apareceu em dois filmes para adolescentes: Três Mulheres, Três Amores (1988) e Satisfaction: No Amor e no Rock (1988). Os filmes a introduziaram à uma novo público que instantaneamente se apaixonou por esta linda mulher. O maior sucesso de Julia foi em Uma Linda Mulher (1990), pelo qual ganhou uma indicação ao Oscar, e também ganhou o People's Choice Award de Atriz Favorita. Embora Julia tenha passado os anos seguintes estrelando filmes sérios ou em papéis de fantasia como Tinkerbell, o público sempre prefere vê-la em comédias românticas. Com O Casamento do Meu Melhor Amigo (1997) Julia deu vida nova ao gênero, que estava esquecido em Hollywood já há algum tempo.Em 2000, Roberts se tornou a primeira atriz a receber 20 milhões, por atuar em Erin Brockovich, de Steven Soderbergh. Sua atuação lhe rendeu o Oscar de melhor atriz, o BAFTA de melhor atriz, e o Globo de Ouro de melhor atriz (drama). No ano seguinte ela estrelou no filme America's Sweethearts (2001), novamente com Soderbergh na comédia Ocean's Eleven (2001). Roberts atuou em 2003 no drama Mona Lisa Smile, que lhe rendeu o até então salário recorde de 25 milhões. No ano seguinte, ela estrelou no drama romântico Closer (2004), e também na sequência Ocean's Twelve (2004). Em 2006, ela emprestou sua voz à duas animações: The Ant Bully e Charlotte's Web. Julia reapareceu nas comédias dramáticas Charlie Wilson's War (2007) e Eat Pray Love (2010), seguidas por August: Osage County (2013), pelo qual foi indicada ao Oscar de melhor atriz coadjuvante. Em 2016, Julia interpretou uma produtora de TV em Money Monster e no ano seguinte, uma mãe lidando com seu filho que sofre da síndrome de Treacher Collins na comédia dramática Wonder.

###Descrição

```{r}
b = filmes %>%
        group_by(ano) %>% 
        mutate(bilheteria_anual = sum(bilheteria)) %>% 
        ggplot(aes(x = ano,
                   y = bilheteria_anual)) + 
        geom_point(size = 3,
                   color = "lightblue")+
        labs(title = "Bilheteria anual de Julia Roberts")
ggplotly(b)

a = filmes %>% 
        ggplot(aes(x = reorder(filme,avaliacao),
                   y = avaliacao))  + 
        geom_point(size = 3,
                   color = "lightgreen") + 
        scale_y_log10() +
        coord_flip()
ggplotly(a)
```

    Nos últimos anos, filmes com Julia Roberts têm caído em arrecadações. Quanto às suas avaliações, percebemos a formação de 4 grupos de filmes, se considerarmos os dois piores avaliados no mesmo grupo.

###Bilheteria X Avaliação

```{r}
filmes %>% 
    ggplot(aes(x = log10(bilheteria),
               y = log10(avaliacao))) + 
    geom_point() +
    geom_smooth(method="lm", se=FALSE) +
    labs(title="Bilheteria X Avaliação") +
    theme_bw()

filmes %>% 
  summarise(pearson = cor(bilheteria, avaliacao, method = "pearson"), 
            spearman = cor(bilheteria, avaliacao, method = "spearman"), 
            kendall = cor(bilheteria, avaliacao, method = "kendall"), )
```

    Ainda que muito fraca, percebe-se uma correlação positiva entre as variáveis bilheteria e avaliação.


###Agrupando os filmes de Julia Roberts

###Transformação das variáveis

    Ajustamos a disparidade entre as escalas das variáveis bilheteria e avaliação.

```{r}
filmes_scaled = filmes %>% 
    mutate(bilheteria_log = as.vector(scale(log10(bilheteria))), 
           avaliacao_scaled = as.vector(scale(avaliacao))) 
    
filmes_scaled %>% 
    select(bilheteria_log, avaliacao_scaled) %>% 
    summary()
```

###O agrupamento de fato

```{r}
n_clusters = 4

km = filmes_scaled %>% 
        select(bilheteria_log, avaliacao_scaled) %>% 
        kmeans(centers = n_clusters, nstart = 20)

agrupado = km %>%
    augment(filmes_scaled)
p = agrupado %>% 
        ggplot(aes(x = avaliacao_scaled,
                   y = bilheteria_log,
                   color = .cluster,
                   label = filme))  + 
        geom_point(size = 2) 
ggplotly(p)

```

    Grupo - Larry Crowne:
        - Larry Crowne
        - Mother's Day
        
    Grupo - Ocean's Twelve:
        - America's Sweethearts
        - Eat Pray Love
        - Mirror Mirror
        - Mona Lisa Smile
        - Ocean's Twelve
        - The Mexican
        - Valentine's Day
        
    Grupo - Closer:
        - August: Osage County
        - Closer
        - Duplicity
        - The Ant Buly
    
    Grupo - Wonder:
        - Charlie Wilson's War
        - Charlotte's Web
        - Ocean's Eleven
        - Wonder

